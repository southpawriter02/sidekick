# v1.0.4 - Extensibility API

> **Release Date:** 2026-02-06  
> **Category:** API

---

## Overview

This version introduces the **Extensibility API** for third-party plugin integration, enabling custom prompt templates, agent tools, and visual enhancements.

---

## New Features

### Extension API (`com.sidekick.api`)

#### Interfaces (`ExtensionModels.kt`)

| Interface | Purpose |
|-----------|---------|
| `SidekickExtension` | Base extension with lifecycle |
| `PromptTemplateExtension` | Custom prompt templates |
| `AgentToolExtension` | Custom agent tools |
| `VisualExtension` | Visual enhancements |

#### Data Classes

| Type | Purpose |
|------|---------|
| `CustomPromptTemplate` | Template with variable substitution |
| `TemplateVariable` | Variable definition |
| `ExtensionTool` | Tool with handler |
| `ToolParameter` / `ToolResult` | Tool I/O |
| `VisualEnhancement` | UI enhancement |

#### Extension Manager (`ExtensionManager.kt`)

- **`getAllPromptTemplates()`** - Aggregate from all extensions
- **`getAllAgentTools()`** - Aggregate from all extensions
- **`getAllVisualEnhancements()`** - Aggregate from all extensions
- **`registerExtension()` / `unregisterExtension()`** - Programmatic registration
- Event listeners for extension lifecycle

---

## Extension Points

Register in `plugin.xml`:
```xml
<extensions defaultExtensionNs="com.sidekick">
    <promptTemplateExtension implementation="com.example.MyTemplates"/>
    <agentToolExtension implementation="com.example.MyTools"/>
    <visualExtension implementation="com.example.MyVisuals"/>
</extensions>
```

---

## Test Coverage

| File | Tests |
|------|-------|
| `ExtensionModelsTest.kt` | ~35 |
| `ExtensionManagerTest.kt` | ~30 |

---

## Usage Example

```kotlin
// Implement a prompt template extension
class MyExtension : PromptTemplateExtension {
    override val id = "com.example.my-ext"
    override val name = "My Extension"
    override val version = "1.0.0"
    override val description = "Adds templates"

    override fun initialize() { /* setup */ }
    override fun dispose() { /* cleanup */ }

    override fun getTemplates() = listOf(
        CustomPromptTemplate(
            id = "refactor",
            name = "Refactor Code",
            template = "Refactor: {{code}}",
            category = "coding",
            variables = listOf(TemplateVariable.code("code"))
        )
    )
}
```
