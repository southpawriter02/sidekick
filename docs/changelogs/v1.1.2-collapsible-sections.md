# v1.1.2 — Collapsible Context Sections

**Released:** 2026-02-07

## Summary

Large code blocks in assistant messages are now automatically collapsed behind
a clickable header when streaming finishes, keeping the chat scrollable and
focused.

## New Features

### Auto-Collapsible Code Blocks

- Code blocks with **8+ lines** are collapsed after streaming completes
- Header shows `▶ language (N lines)` — click to expand/collapse
- Small code blocks (< 8 lines) remain inline as before
- User messages are never collapsed (they're typically short)
- Raw text is preserved for clipboard copy and Markdown export (v1.1.1)

## Files Changed

| File                        | Change                                                                     |
| --------------------------- | -------------------------------------------------------------------------- |
| `ContentBlockParser.kt`     | **NEW** — Parses text into `Text` / `CodeFence` blocks                     |
| `CollapsibleSection.kt`     | **NEW** — Swing panel with clickable expand/collapse header                |
| `MessageBubble.kt`          | Added `rawText` field, `bodyPanel`, `rebuildBodyWithCollapsibleSections()` |
| `SidekickBundle.properties` | Added 3 localized strings for collapsible sections                         |
| `plugin.xml`                | Added v1.1.2 change-notes                                                  |
| `ContentBlockParserTest.kt` | **NEW** — 16 unit tests for parsing and threshold logic                    |
